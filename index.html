<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn-icons-png.flaticon.com/512/189/189688.png" rel="icon" type="image/png"/>
    <title id="dynamicTitle">KM to Miles Converter</title>
    <meta content="Easily convert kilometers to miles with our fast, accurate online tool." id="metaDescription" name="description"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>

    <style>
    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }
    body {
        font-family: 'Inter', sans-serif;
        background: #f4f7fa;
        color: #1f2a44;
        line-height: 1.5;
    }
    .main-content {
        padding: 40px;
        max-width: 1000px;
        margin: 0 auto;
    }
    .header {
        background: #ffffff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 30px;
        text-align: center;
    }
    .header h1 {
        font-size: 2em;
        color: #1f2a44;
    }
    .header h1 a {
        color: #14b8a6;
        text-decoration: none;
    }
    .header nav {
        margin-top: 10px;
    }
    .header nav a {
        color: #14b8a6;
        text-decoration: none;
        margin: 0 10px;
        font-weight: 600;
    }
    .header nav a:hover {
        text-decoration: underline;
    }
    .card {
        background: #ffffff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
    }
    .calculator {
        text-align: center;
    }
    .calculator input {
        padding: 10px;
        width: 100%;
        max-width: 200px;
        border: 1px solid #d1d5db;
        border-radius: 5px;
        font-size: 1em;
        margin-bottom: 10px;
    }
    .calculator button {
        padding: 10px 20px;
        background: #14b8a6;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s;
    }
    .calculator button:hover {
        background: #0d9488;
    }
    .result {
        margin-top: 15px;
        font-size: 1.2em;
        font-weight: 600;
        color: #14b8a6;
    }
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 15px;
    }
    .grid-item {
        background: #f9fafb;
        padding: 10px;
        text-align: center;
        border-radius: 5px;
        transition: transform 0.3s;
    }
    .grid-item:hover {
        transform: scale(1.05);
    }
    .grid-item a {
        color: #14b8a6;
        text-decoration: none;
        font-weight: 600;
    }
    .table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }
    .table th, .table td {
        padding: 10px;
        border: 1px solid #e5e7eb;
        text-align: center;
    }
    .table th {
        background: #14b8a6;
        color: #fff;
    }
    .formula, .steps, .explanation {
        margin-top: 20px;
        padding: 15px;
        background: #f9fafb;
        border-radius: 5px;
    }
    .formula h3, .steps h3, .explanation h3 {
        color: #14b8a6;
        margin-bottom: 10px;
    }
    .sitemap pre {
        background: #f9fafb;
        padding: 15px;
        border-radius: 5px;
        font-size: 0.9em;
        white-space: pre-wrap;
        max-height: 400px;
        overflow-y: auto;
    }
    .sitemap button {
        margin-top: 15px;
        padding: 10px 20px;
        background: #14b8a6;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    .sitemap button:hover {
        background: #0d9488;
    }
    .footer {
        text-align: center;
        padding: 20px;
        background: #ffffff;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
        margin-top: 40px;
    }
    @media (max-width: 768px) {
        .main-content {
            padding: 20px;
        }
        .header h1 {
            font-size: 1.5em;
        }
        .header nav a {
            display: block;
            margin: 5px 0;
        }
    }
    </style>
</head>
<body>
    <div class="main-content">
        <div class="header">
            <h1><a href="/" onclick="navigateTo('/'); return false;">KM to Miles Converter</a></h1>
            <nav>
                <a href="/" onclick="navigateTo('/'); return false;">Home</a>
                <a href="/sitemap.xml" onclick="navigateTo('/sitemap.xml'); return false;">Sitemap</a>
            </nav>
        </div>
        <div class="card calculator">
            <input id="inputValue" placeholder="Enter KM (e.g., 10)" type="number"/>
            <button onclick="convertKmToMiles()">Convert</button>
            <div class="result" id="result"></div>
        </div>
        <div class="card" id="gridContainer">
            <div class="grid"></div>
        </div>
        <div class="card sitemap" id="sitemapContainer" style="display: none;">
            <h3>Sitemap Preview (1-1000 KM)</h3>
            <pre id="sitemap"></pre>
            <button onclick="downloadSitemap()">Download Sitemap.xml</button>
        </div>
        <div class="card" id="detailedContent" style="display: none;">
            <div class="table-container">
                <h3>Nearby Conversions</h3>
                <table class="table" id="kmToMilesTable">
                    <thead>
                        <tr>
                            <th>KM</th>
                            <th>Miles</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="formula">
                <h3>How It Works</h3>
                <p>Multiply kilometers by 0.621371 to get miles.</p>
            </div>
            <div class="steps">
                <h3>Conversion Steps</h3>
                <p id="stepExplanation"></p>
            </div>
            <div class="explanation">
                <h3>Why It Matters</h3>
                <p id="explanationText"></p>
            </div>
        </div>
        <div class="footer">
            <p>© 2025 KM to Miles Converter. All rights reserved.</p>
        </div>
    </div>

    <script>
    function updatePageMetadata(km) {
        const titleElement = document.getElementById('dynamicTitle');
        const metaDescription = document.getElementById('metaDescription');
        if (!isNaN(km)) {
            document.title = `${km} KM to Miles Converter`;
            titleElement.textContent = `${km} KM to Miles Converter`;
            if (metaDescription) {
                metaDescription.setAttribute('content', `Convert ${km} kilometers to miles instantly with our easy-to-use tool.`);
            }
        }
    }

    function getBaseUrl() {
        return window.location.origin;
    }

    function navigateTo(path) {
        const baseUrl = getBaseUrl();
        const fullPath = path === '/' ? baseUrl : `${baseUrl}${path}`;
        window.history.pushState({}, '', fullPath);
        renderPage();
    }

    function generateFullSitemap() {
        const baseUrl = getBaseUrl();
        const currentDate = new Date().toISOString().split('T')[0];
        
        let sitemap = '<?xml version="1.0" encoding="UTF-8"?>\n';
        sitemap += '<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">\n';
        
        // Add home page
        sitemap += '  <url>\n';
        sitemap += `    <loc>${baseUrl}/</loc>\n`;
        sitemap += `    <lastmod>${currentDate}</lastmod>\n`;
        sitemap += '    <changefreq>daily</changefreq>\n';
        sitemap += '    <priority>1.0</priority>\n';
        sitemap += '  </url>\n';
        
        // Add sitemap page
        sitemap += '  <url>\n';
        sitemap += `    <loc>${baseUrl}/p/sitemap.xml</loc>\n`;
        sitemap += `    <lastmod>${currentDate}</lastmod>\n`;
        sitemap += '    <changefreq>monthly</changefreq>\n';
        sitemap += '    <priority>0.5</priority>\n';
        sitemap += '  </url>\n';
        
        // Add all conversion pages
        for (let i = 1; i <= 1000; i++) {
            const url = `${baseUrl}/${i}-km-to-mi`;
            sitemap += '  <url>\n';
            sitemap += `    <loc>${url}</loc>\n`;
            sitemap += `    <lastmod>${currentDate}</lastmod>\n`;
            sitemap += '    <changefreq>monthly</changefreq>\n';
            sitemap += '    <priority>0.8</priority>\n';
            sitemap += '  </url>\n';
        }
        
        sitemap += '</urlset>';
        return sitemap;
    }

    function generateSitemapPreview() {
        const sitemapContent = generateFullSitemap();
        document.getElementById("sitemap").textContent = sitemapContent;
    }

    function downloadSitemap() {
        const sitemapContent = generateFullSitemap();
        const blob = new Blob([sitemapContent], { type: 'text/xml' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'sitemap.xml';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

    function renderPage() {
        const currentPath = window.location.pathname.toLowerCase() || '/';
        const gridContainer = document.getElementById('gridContainer');
        const detailedContent = document.getElementById('detailedContent');
        const sitemapContainer = document.getElementById('sitemapContainer');

        let km = null;
        if (currentPath.match(/^\/(\d+)-km-to-mi$/)) {
            const match = currentPath.match(/\/(\d+)-km-to-mi/);
            if (match) km = parseFloat(match[1]);
        }

        if (currentPath === '/' || currentPath === '') {
            gridContainer.style.display = 'block';
            sitemapContainer.style.display = 'none';
            detailedContent.style.display = 'none';
            generateConversionGrid();
            document.title = 'KM to Miles Converter';
            document.getElementById('metaDescription').setAttribute('content', 'Easily convert kilometers to miles with our fast, accurate online tool.');
        } else if (currentPath === '/p/sitemap.xml') {
            gridContainer.style.display = 'none';
            detailedContent.style.display = 'none';
            sitemapContainer.style.display = 'block';
            generateSitemapPreview();
        } else if (!isNaN(km)) {
            gridContainer.style.display = 'none';
            sitemapContainer.style.display = 'none';
            detailedContent.style.display = 'block';
            updatePageMetadata(km);
            showDetailedConversion(km);
        } else {
            navigateTo('/');
        }
    }

    function generateConversionGrid() {
        const grid = document.querySelector('.grid');
        grid.innerHTML = '';
        for (let i = 1; i <= 500; i += 10) {
            const gridItem = document.createElement('div');
            gridItem.className = 'grid-item';
            gridItem.innerHTML = `<a href="/${i}-km-to-mi" onclick="navigateTo('/${i}-km-to-mi'); return false;">${i} KM To MI</a>`;
            grid.appendChild(gridItem);
        }
    }

    function showDetailedConversion(km) {
        const inputValue = document.getElementById('inputValue');
        const resultDiv = document.getElementById('result');
        inputValue.value = km;
        const miles = km * 0.621371;
        resultDiv.innerHTML = `${km} KM equals ${miles.toFixed(2)} miles`;

        const tableBody = document.querySelector('#kmToMilesTable tbody');
        tableBody.innerHTML = '';
        for (let i = 1; i <= 9; i++) {
            const incrementalValue = km + (i / 10);
            const convertedValue = incrementalValue * 0.621371;
            tableBody.innerHTML += `<tr><td>${incrementalValue.toFixed(1)}</td><td>${convertedValue.toFixed(2)}</td></tr>`;
        }

        document.getElementById('stepExplanation').innerHTML = `
            1. Take ${km} kilometers.<br>
            2. Multiply by 0.621371.<br>
            3. Get ${miles.toFixed(2)} miles.<br>
            4. Add 0.1 KM for next steps, e.g., ${(km + 0.1).toFixed(1)} KM = ${((km + 0.1) * 0.621371).toFixed(2)} miles.
        `;

        document.getElementById('explanationText').innerHTML = `
            Switching from kilometers to miles is quick and easy! Start with ${km} KM, multiply by 0.621371 (the magic number for this conversion), and you’ll land on ${miles.toFixed(2)} miles. It’s a handy trick for travel, fitness, or just satisfying your curiosity!
        `;
    }

    function convertKmToMiles() {
        const km = parseFloat(document.getElementById('inputValue').value);
        if (!isNaN(km)) {
            navigateTo(`/${km}-km-to-mi`);
        }
    }

    window.addEventListener('popstate', renderPage);
    window.addEventListener('load', renderPage);
    </script>
</body>
</html>
